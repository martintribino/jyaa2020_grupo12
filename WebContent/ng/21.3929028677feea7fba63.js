(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{ARp9:function(t,a,i){"use strict";i.r(a),i.d(a,"ArtistaModule",(function(){return G}));var e=i("ofXK"),s=i("Wp6s"),r=i("f0Cb"),o=i("NFeN"),n=i("0IaG"),c=i("bTqV"),l=i("dNgK"),b=i("Qu3c"),u=i("Xa2L"),d=i("tyNb"),h=i("2Vo4"),g=i("qR9t"),m=i("wimQ"),f=i("nVpM"),p=i("fCl4"),v=i("fXoL"),T=i("lGQG"),A=i("gOGa"),S=i("dXND"),w=i("/1K/"),U=i("ytFt"),j=i("m1IW"),y=i("TU8p");function B(t,a){1&t&&v.Pb(0,"div")}const I=function(t){return["/obras/",t]};function k(t,a){if(1&t&&(v.Ub(0,"div",5),v.Ub(1,"a",13),v.Ub(2,"span"),v.Ac(3),v.Tb(),v.Tb(),v.Tb()),2&t){const t=a.$implicit;v.Bb(1),v.lc("routerLink",v.nc(2,I,t.id)),v.Bb(2),v.Bc(t.nombre)}}function q(t,a){1&t&&(v.Ub(0,"div",5),v.Ub(1,"span"),v.Ac(2,"No pertenece a alguna obra por el momento."),v.Tb(),v.Tb())}function P(t,a){1&t&&v.Pb(0,"div")}function M(t,a){if(1&t){const t=v.Vb();v.Ub(0,"button",14),v.bc("click",(function(){return v.sc(t),v.fc(2).onAddPhoto()})),v.Ub(1,"mat-icon"),v.Ac(2,"add_a_photo"),v.Tb(),v.Tb(),v.Ub(3,"button",15),v.bc("click",(function(){return v.sc(t),v.fc(2).onEdit()})),v.Ub(4,"mat-icon"),v.Ac(5,"edit"),v.Tb(),v.Tb(),v.Ub(6,"button",16),v.bc("click",(function(){return v.sc(t),v.fc(2).onConfirmDelete()})),v.Ub(7,"mat-icon"),v.Ac(8,"delete"),v.Tb(),v.Tb()}if(2&t){const t=v.fc(2);v.lc("disabled",t.loading),v.Bb(3),v.lc("disabled",t.loading),v.Bb(3),v.lc("disabled",t.loading)}}const O=function(){return["/artistas/"]};function E(t,a){if(1&t){const t=v.Vb();v.Ub(0,"mat-card",3),v.Ub(1,"mat-card-title"),v.Ac(2),v.gc(3,"async"),v.Tb(),v.Pb(4,"app-carrusel-imagenes",4),v.gc(5,"async"),v.Ub(6,"mat-card-content"),v.Ub(7,"div",5),v.Ub(8,"strong"),v.Ac(9,"Nombre"),v.Tb(),v.Ub(10,"span"),v.Ac(11),v.gc(12,"async"),v.Tb(),v.Tb(),v.Pb(13,"mat-divider"),v.Ub(14,"div",5),v.Ub(15,"strong"),v.Ac(16,"Apellido"),v.Tb(),v.Ub(17,"span"),v.Ac(18),v.gc(19,"async"),v.Tb(),v.Tb(),v.Pb(20,"mat-divider"),v.Ub(21,"div",5),v.Ub(22,"strong"),v.Ac(23,"Obras"),v.Tb(),v.Tb(),v.yc(24,k,4,4,"div",6),v.gc(25,"async"),v.yc(26,q,3,0,"div",7),v.gc(27,"async"),v.gc(28,"async"),v.Pb(29,"mat-divider"),v.Ub(30,"app-etiquetas-entidad",8),v.bc("agregar",(function(a){return v.sc(t),v.fc().agregarEtiqueta(a)}))("eliminar",(function(a){return v.sc(t),v.fc().eliminarEtiqueta(a)})),v.gc(31,"async"),v.Tb(),v.Tb(),v.Ub(32,"mat-card-actions"),v.Ub(33,"button",9),v.Ub(34,"mat-icon"),v.Ac(35,"arrow_back_ios"),v.Tb(),v.Tb(),v.Ub(36,"button",10),v.bc("click",(function(){return v.sc(t),v.fc().onToggleFavorito()})),v.gc(37,"async"),v.Ub(38,"mat-icon"),v.Ac(39,"favorite"),v.Tb(),v.Tb(),v.yc(40,P,1,0,"div",11),v.yc(41,M,9,3,"ng-template",null,12,v.zc),v.Tb(),v.Tb()}if(2&t){const t=v.pc(42),a=v.fc();var i,e;const l=null==(e=v.hc(5,18,a.artista))?null:e.fotos;var s,r,o=null;const b=null==v.hc(27,26,a.obras)||0==(null==(o=v.hc(28,28,a.obras))?null:o.length);var n;const u=null==(n=v.hc(31,30,a.artista))?null:n.etiquetas;var c;const d=null==(c=v.hc(37,32,a.artista))?null:c.usuariosFav.length;v.Bb(2),v.Bc(null==(i=v.hc(3,16,a.artista))?null:i.apodo),v.Bb(2),v.lc("slides",l),v.Bb(7),v.Bc(null==(s=v.hc(12,20,a.artista))?null:s.nombre),v.Bb(7),v.Bc(null==(r=v.hc(19,22,a.artista))?null:r.apellido),v.Bb(6),v.lc("ngForOf",v.hc(25,24,a.obras)),v.Bb(2),v.lc("ngIf",b),v.Bb(4),v.lc("etiquetas",u)("selectable",a.selectable)("loading",a.loading),v.Bb(3),v.lc("routerLink",v.mc(34,O)),v.Bb(3),v.Db(a.favorito),v.lc("disabled",a.loading)("matBadge",d),v.Bb(4),v.lc("ngIf",a.isAdmin())("ngIfThen",t)}}function F(t,a){1&t&&v.Pb(0,"mat-spinner")}function C(t,a){1&t&&(v.Ub(0,"h5"),v.Ac(1,"No se pudo cargar el artista."),v.Tb())}function N(t,a){if(1&t&&(v.yc(0,F,1,0,"mat-spinner",17),v.yc(1,C,2,0,"h5",17)),2&t){const t=v.fc();v.lc("ngIf",t.loading),v.Bb(1),v.lc("ngIf",!t.loading)}}const V=[{path:"",component:(()=>{class t{constructor(t,a,i,e,s,r,o,n,c){this.authService=t,this.artistaServ=a,this.obraServ=i,this.archivoServ=e,this.snackBar=s,this.dialog=r,this.router=o,this.route=n,this.changeDetector=c,this.artistaSubject=new h.a(null),this.artista=this.artistaSubject.asObservable(),this.obrasSubject=new h.a([]),this.obras=this.obrasSubject.asObservable(),this.loading=!1,this.id=null,this.favorito="",this.selectable=!1,this.imgPath="ng/assets/images/user.png",this.route.params.subscribe(t=>{this.id=parseInt(t.id)})}ngAfterViewChecked(){this.changeDetector.detectChanges()}ngAfterViewInit(){this.loading=!0,this.artistaServ.getArtista(this.id).subscribe(t=>this.onSuccess(t),t=>this.onError(t),()=>this.loading=!1),this.obraServ.getObrasPorArtista(this.id).subscribe(t=>{this.obrasSubject.next(t)},t=>{this.obrasSubject.next([])})}onSuccess(t){var a=this.authService.getUsuario(),i="";t.usuariosFav.map(t=>{t.nombreUsuario==a.nombreUsuario&&(i="favorito")}),this.favorito=i,this.artistaSubject.next(t),this.loading=!1}onError(t){this.artistaSubject.next(null),this.loading=!1}getFotos(){let t=this.artistaSubject.value;return null!=t&&Array.isArray(t.fotos)?t.fotos:[]}onAddPhoto(){let t=this.artistaSubject.value;null!=t&&this.dialog.open(f.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:{action:g.a.crear,path:"artista",data:t}}).afterClosed().subscribe(t=>{this.ngAfterViewInit()})}onToggleFavorito(){let t=this.artistaSubject.value;null!=t&&this.artistaServ.toggleArtistaFav(t).subscribe(()=>{this.mostrarMensaje("Se ha actualizado su inter\xe9s correctamente","success"),this.ngAfterViewInit()},()=>{this.mostrarMensaje("No se ha actualizado su inter\xe9s correctamente","error"),this.loading=!1})}onEdit(){let t=this.artistaSubject.value;null!=t&&this.dialog.open(m.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:{action:g.a.editar,data:t}}).afterClosed().subscribe(t=>{let a=t;null!=a&&this.artistaServ.actualizarArtista(a).subscribe(()=>{this.mostrarMensaje("Se ha editado correctamente el artista "+a.nombre,"success"),this.ngAfterViewInit()},()=>{this.mostrarMensaje("No se ha podido actualizar el artista "+a.nombre,"error")})})}onConfirmDelete(){this.dialog.open(p.a,{data:{titulo:"Confirmar Borrado",subtitulo:"Est\xe1 seguro que desea borrar al artista?"}}).afterClosed().subscribe(t=>{t&&this.onDelete()})}onDelete(){let t=this.artistaSubject.value;null!=t&&(this.loading=!0,this.artistaServ.eliminarArtista(t).subscribe(()=>{this.mostrarMensaje("Se ha dado de baja correctamente al artista "+t.nombre,"success"),this.router.navigate(["/artistas"])},()=>{this.mostrarMensaje("No se ha podido dar de baja el artista "+t.nombre,"error"),this.loading=!1},()=>{this.loading=!1}))}agregarEtiqueta(t){let a=this.artistaSubject.value;if(null!=a){let i=[...a.etiquetas];this.loading=!0,this.artistaServ.agregarEtiqueta(t,a).subscribe(()=>{this.mostrarMensaje("Se ha agregado la etiqueta "+t,"success"),this.ngAfterViewInit(),this.loading=!1},()=>{this.mostrarMensaje("No se ha podido agregar la etiqueta "+t,"error"),a.etiquetas=i,this.loading=!1},()=>{this.loading=!1})}}eliminarEtiqueta(t){let a=this.artistaSubject.value;null!=a&&(a.etiquetas=a.etiquetas.filter(a=>a.id!=t.id),this.loading=!0,this.artistaServ.actualizarArtista(a).subscribe(()=>{this.mostrarMensaje("Se ha eliminado la etiqueta","success"),this.ngAfterViewInit(),this.loading=!1},()=>{this.mostrarMensaje("No se ha podido eliminar la etiqueta","error"),this.loading=!1},()=>{this.loading=!1}))}mostrarMensaje(t,a="",i=g.d,e="bottom"){this.snackBar.open(t,"",{duration:i,verticalPosition:e,panelClass:a})}isAdmin(){let t=this.authService.getUsuario();return null!=t&&t.rol==g.e.Administrador}}return t.\u0275fac=function(a){return new(a||t)(v.Ob(T.a),v.Ob(A.a),v.Ob(S.a),v.Ob(w.a),v.Ob(l.a),v.Ob(n.b),v.Ob(d.b),v.Ob(d.a),v.Ob(v.h))},t.\u0275cmp=v.Ib({type:t,selectors:[["app-artista"]],decls:6,vars:5,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["ifBlock",""],["elseBlock",""],[1,"default-card"],[3,"slides"],[1,"card-row"],["class","card-row",4,"ngFor","ngForOf"],["class","card-row",4,"ngIf"],[3,"etiquetas","selectable","loading","agregar","eliminar"],["mat-icon-button","","matTooltip","Volver","matTooltipPosition","below","aria-label","Volver",1,"row-profile-button",3,"routerLink"],["mat-icon-button","","matTooltip","Me interesa","matTooltipPosition","below","aria-label","Artista Favorito","matBadgeSize","small",1,"row-profile-button",3,"disabled","matBadge","click"],[4,"ngIf","ngIfThen"],["ifAdminBlock",""],[1,"entidad",3,"routerLink"],["mat-icon-button","","matTooltip","Agregar Fotos","matTooltipPosition","below","aria-label","Agregar Fotos",1,"row-profile-button",3,"disabled","click"],["mat-icon-button","","matTooltip","Editar Artista","matTooltipPosition","below","aria-label","Editar Artista",1,"row-profile-button",3,"disabled","click"],["mat-icon-button","","matTooltip","Eliminar Artista","matTooltipPosition","below","aria-label","Eliminar Artista",1,"row-profile-button",3,"disabled","click"],[4,"ngIf"]],template:function(t,a){if(1&t&&(v.yc(0,B,1,0,"div",0),v.gc(1,"async"),v.yc(2,E,43,35,"ng-template",null,1,v.zc),v.yc(4,N,2,2,"ng-template",null,2,v.zc)),2&t){const t=v.pc(3),i=v.pc(5);v.lc("ngIf",null!=v.hc(1,3,a.artista))("ngIfThen",t)("ngIfElse",i)}},directives:[e.n,s.a,s.g,U.a,s.c,r.a,e.m,j.a,s.b,c.a,b.a,d.c,o.a,y.a,d.e,u.b],pipes:[e.b],styles:[".mat-progress-spinner[_ngcontent-%COMP%]{margin-top:2em}app-carrusel-imagenes[_ngcontent-%COMP%]{margin:1em auto;display:block}"]}),t})()}];let L=(()=>{class t{}return t.\u0275mod=v.Mb({type:t}),t.\u0275inj=v.Lb({factory:function(a){return new(a||t)},imports:[[d.f.forChild(V)],d.f]}),t})();var x=i("ugYk"),z=i("zOQo"),D=i("FKr1");i("8LU1"),i("FtGj"),i("3Pt+"),i("R1ws"),i("nLfN"),i("quSY"),i("u47x"),i("cH1L");let _=(()=>{class t{}return t.\u0275mod=v.Mb({type:t}),t.\u0275inj=v.Lb({factory:function(a){return new(a||t)},imports:[[e.c,D.i],D.i]}),t})(),G=(()=>{class t{}return t.\u0275mod=v.Mb({type:t}),t.\u0275inj=v.Lb({factory:function(a){return new(a||t)},providers:[],imports:[[L,x.a,z.a,e.c,s.e,r.b,o.b,c.b,n.f,b.b,l.b,u.a,y.b,_]]}),t})()}}]);