(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{D2Nj:function(t,a,i){"use strict";i.r(a),i.d(a,"ObraModule",(function(){return x}));var o=i("ofXK"),e=i("NFeN"),n=i("0IaG"),r=i("bTqV"),s=i("Xa2L"),c=i("Qu3c"),l=i("tyNb"),b=i("qR9t"),u=i("2Vo4"),d=i("hbUw"),g=i("nVpM"),h=i("fCl4"),m=i("fXoL"),f=i("lGQG"),p=i("dXND"),v=i("dNgK"),T=i("Wp6s"),U=i("ytFt"),O=i("f0Cb"),y=i("m1IW"),S=i("TU8p");function B(t,a){1&t&&m.Pb(0,"div")}const j=function(t){return["/artistas/",t]};function w(t,a){if(1&t&&(m.Ub(0,"div",5),m.Ub(1,"a",13),m.Ub(2,"span"),m.Ac(3),m.Tb(),m.Tb(),m.Tb()),2&t){const t=a.$implicit;m.Bb(1),m.lc("routerLink",m.nc(3,j,t.id)),m.Bb(2),m.Dc("",t.nombre,"",t.apellido,"")}}function I(t,a){1&t&&(m.Ub(0,"div",5),m.Ub(1,"span"),m.Ac(2,"No tiene artistas."),m.Tb(),m.Tb())}function A(t,a){1&t&&m.Pb(0,"div")}function k(t,a){if(1&t){const t=m.Vb();m.Ub(0,"button",14),m.bc("click",(function(){return m.sc(t),m.fc(2).onAddPhoto()})),m.Ub(1,"mat-icon"),m.Ac(2,"add_a_photo"),m.Tb(),m.Tb(),m.Ub(3,"button",15),m.bc("click",(function(){return m.sc(t),m.fc(2).onEdit()})),m.Ub(4,"mat-icon"),m.Ac(5,"edit"),m.Tb(),m.Tb(),m.Ub(6,"button",16),m.bc("click",(function(){return m.sc(t),m.fc(2).onConfirmDelete()})),m.Ub(7,"mat-icon"),m.Ac(8,"delete"),m.Tb(),m.Tb()}if(2&t){const t=m.fc(2);m.lc("disabled",t.loading),m.Bb(3),m.lc("disabled",t.loading),m.Bb(3),m.lc("disabled",t.loading)}}const q=function(){return["/obras/"]};function M(t,a){if(1&t){const t=m.Vb();m.Ub(0,"mat-card",3),m.Ub(1,"mat-card-title"),m.Ac(2),m.gc(3,"async"),m.Tb(),m.Pb(4,"app-carrusel-imagenes",4),m.gc(5,"async"),m.Ub(6,"mat-card-content"),m.Ub(7,"div",5),m.Ub(8,"strong"),m.Ac(9,"Descripci\xf3n"),m.Tb(),m.Ub(10,"span"),m.Ac(11),m.gc(12,"async"),m.Tb(),m.Tb(),m.Pb(13,"mat-divider"),m.Ub(14,"div",5),m.Ub(15,"strong"),m.Ac(16,"Duraci\xf3n"),m.Tb(),m.Ub(17,"span"),m.Ac(18),m.gc(19,"async"),m.Tb(),m.Tb(),m.Pb(20,"mat-divider"),m.Ub(21,"div",5),m.Ub(22,"strong"),m.Ac(23,"Artistas"),m.Tb(),m.Tb(),m.yc(24,w,4,5,"div",6),m.gc(25,"async"),m.yc(26,I,3,0,"div",7),m.gc(27,"async"),m.gc(28,"async"),m.Pb(29,"mat-divider"),m.Ub(30,"app-etiquetas-entidad",8),m.bc("agregar",(function(a){return m.sc(t),m.fc().agregarEtiqueta(a)}))("eliminar",(function(a){return m.sc(t),m.fc().eliminarEtiqueta(a)})),m.gc(31,"async"),m.Tb(),m.Tb(),m.Ub(32,"mat-card-actions"),m.Ub(33,"button",9),m.Ub(34,"mat-icon"),m.Ac(35,"arrow_back_ios"),m.Tb(),m.Tb(),m.Ub(36,"button",10),m.bc("click",(function(){return m.sc(t),m.fc().onToggleFavorito()})),m.gc(37,"async"),m.Ub(38,"mat-icon"),m.Ac(39,"favorite"),m.Tb(),m.Tb(),m.yc(40,A,1,0,"div",11),m.yc(41,k,9,3,"ng-template",null,12,m.zc),m.Tb(),m.Tb()}if(2&t){const t=m.pc(42),a=m.fc();var i,o;const b=null==(o=m.hc(5,18,a.obra))?null:o.fotos;var e,n,r;const u=null==(r=m.hc(25,24,a.obra))?null:r.artistas;var s=null;const d=null==(null==(s=m.hc(27,26,a.obra))?null:s.artistas)||0==(null==(s=m.hc(28,28,a.obra))?null:s.artistas.length);var c;const g=null==(c=m.hc(31,30,a.obra))?null:c.etiquetas;var l;const h=null==(l=m.hc(37,32,a.obra))?null:l.usuariosFav.length;m.Bb(2),m.Bc(null==(i=m.hc(3,16,a.obra))?null:i.nombre),m.Bb(2),m.lc("slides",b),m.Bb(7),m.Bc(null==(e=m.hc(12,20,a.obra))?null:e.descripcion),m.Bb(7),m.Bc(null==(n=m.hc(19,22,a.obra))?null:n.duracion),m.Bb(6),m.lc("ngForOf",u),m.Bb(2),m.lc("ngIf",d),m.Bb(4),m.lc("etiquetas",g)("selectable",a.selectable)("loading",a.loading),m.Bb(3),m.lc("routerLink",m.mc(34,q)),m.Bb(3),m.Db(a.favorito),m.lc("disabled",a.loading)("matBadge",h),m.Bb(4),m.lc("ngIf",a.isAdmin())("ngIfThen",t)}}function P(t,a){1&t&&m.Pb(0,"mat-spinner")}function E(t,a){1&t&&(m.Ub(0,"h5"),m.Ac(1,"No se pudo cargar el obra."),m.Tb())}function F(t,a){if(1&t&&(m.yc(0,P,1,0,"mat-spinner",17),m.yc(1,E,2,0,"h5",17)),2&t){const t=m.fc();m.lc("ngIf",t.loading),m.Bb(1),m.lc("ngIf",!t.loading)}}const N=[{path:"",component:(()=>{class t{constructor(t,a,i,o,e,n){this.authService=t,this.obraServ=a,this.snackBar=i,this.dialog=o,this.router=e,this.route=n,this.obraSubject=new u.a(null),this.obra=this.obraSubject.asObservable(),this.loading=!1,this.id=null,this.favorito="",this.selectable=!1,this.route.params.subscribe(t=>{this.id=parseInt(t.id)})}ngOnInit(){this.loading=!0,this.obraServ.getObra(this.id).subscribe(t=>this.onSuccess(t),t=>this.onError(t),()=>this.loading=!1)}onSuccess(t){var a=this.authService.getUsuario(),i="";t.usuariosFav.map(t=>{t.nombreUsuario==a.nombreUsuario&&(i="favorito")}),this.favorito=i,this.obraSubject.next(t),this.loading=!1}onError(t){this.obraSubject.next(null),this.loading=!1}onAddPhoto(){let t=this.obraSubject.value;null!=t&&this.dialog.open(g.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:{action:b.a.crear,path:"obra",data:t}}).afterClosed().subscribe(t=>{this.ngOnInit()})}onToggleFavorito(){this.loading=!0;let t=this.obraSubject.value;null!=t&&this.obraServ.toggleObraFav(t).subscribe(()=>{this.mostrarMensaje("Se ha actualizado su inter\xe9s correctamente","success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha actualizado su inter\xe9s correctamente","error"),this.loading=!1},()=>{this.loading=!1})}onEdit(){let t=this.obraSubject.value;null!=t&&this.dialog.open(d.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:{action:b.a.editar,data:t}}).afterClosed().subscribe(t=>{let a=t;null!=a&&this.obraServ.actualizarObra(a).subscribe(()=>{this.mostrarMensaje("Se ha editado correctamente la obra "+a.nombre,"success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha podido actualizar la obra "+a.nombre,"error")})})}onConfirmDelete(){this.dialog.open(h.a,{data:{titulo:"Confirmar Borrado",subtitulo:"Est\xe1 seguro que desea borrar la obra?"}}).afterClosed().subscribe(t=>{t&&this.onDelete()})}onDelete(){let t=this.obraSubject.value;null!=t&&(this.loading=!0,this.obraServ.eliminarObra(t).subscribe(()=>{this.mostrarMensaje("Se ha dado de baja correctamente la obra "+t.nombre,"success"),this.router.navigate(["/obras"])},()=>{this.mostrarMensaje("No se ha podido dar de baja la obra "+t.nombre,"error"),this.loading=!1},()=>{this.loading=!1}))}agregarEtiqueta(t){let a=this.obraSubject.value;if(null!=a){let i=[...a.etiquetas];this.loading=!0,this.obraServ.agregarEtiqueta(t,a).subscribe(()=>{this.mostrarMensaje("Se ha agregado la etiqueta "+t,"success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha podido agregar la etiqueta "+t,"error"),a.etiquetas=i,this.loading=!1},()=>{this.loading=!1})}}eliminarEtiqueta(t){let a=this.obraSubject.value;null!=a&&(a.etiquetas=a.etiquetas.filter(a=>a.id!=t.id),this.loading=!0,this.obraServ.actualizarObra(a).subscribe(()=>{this.mostrarMensaje("Se ha eliminado la etiqueta","success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha podido eliminar la etiqueta","error"),this.loading=!1},()=>{this.loading=!1}))}mostrarMensaje(t,a="",i=b.d,o="bottom"){this.snackBar.open(t,"",{duration:i,verticalPosition:o,panelClass:a})}isAdmin(){let t=this.authService.getUsuario();return null!=t&&t.rol==b.e.Administrador}}return t.\u0275fac=function(a){return new(a||t)(m.Ob(f.a),m.Ob(p.a),m.Ob(v.a),m.Ob(n.b),m.Ob(l.b),m.Ob(l.a))},t.\u0275cmp=m.Ib({type:t,selectors:[["app-obra"]],decls:6,vars:5,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["ifBlock",""],["elseBlock",""],[1,"default-card"],[3,"slides"],[1,"card-row"],["class","card-row",4,"ngFor","ngForOf"],["class","card-row",4,"ngIf"],[3,"etiquetas","selectable","loading","agregar","eliminar"],["mat-icon-button","","matTooltip","Volver","matTooltipPosition","below","aria-label","Volver",1,"row-profile-button",3,"routerLink"],["mat-icon-button","","matTooltip","Me interesa","matTooltipPosition","below","aria-label","Obra Favorita","matBadgeSize","small",1,"row-profile-button",3,"disabled","matBadge","click"],[4,"ngIf","ngIfThen"],["ifAdminBlock",""],[1,"entidad",3,"routerLink"],["mat-icon-button","","matTooltip","Agregar Fotos","matTooltipPosition","below","aria-label","Agregar Fotos",1,"row-profile-button",3,"disabled","click"],["mat-icon-button","","matTooltip","Editar Obra","matTooltipPosition","below","aria-label","Editar Obra",1,"row-profile-button",3,"disabled","click"],["mat-icon-button","","matTooltip","Eliminar Obra","matTooltipPosition","below","aria-label","Eliminar Obra",1,"row-profile-button",3,"disabled","click"],[4,"ngIf"]],template:function(t,a){if(1&t&&(m.yc(0,B,1,0,"div",0),m.gc(1,"async"),m.yc(2,M,43,35,"ng-template",null,1,m.zc),m.yc(4,F,2,2,"ng-template",null,2,m.zc)),2&t){const t=m.pc(3),i=m.pc(5);m.lc("ngIf",null!=m.hc(1,3,a.obra))("ngIfThen",t)("ngIfElse",i)}},directives:[o.n,T.a,T.g,U.a,T.c,O.a,o.m,y.a,T.b,r.a,c.a,l.c,e.a,S.a,l.e,s.b],pipes:[o.b],styles:[".mat-progress-spinner[_ngcontent-%COMP%]{margin-top:2em}app-carrusel-imagenes[_ngcontent-%COMP%]{margin:1em auto;display:block}"]}),t})()}];let C=(()=>{class t{}return t.\u0275mod=m.Mb({type:t}),t.\u0275inj=m.Lb({factory:function(a){return new(a||t)},imports:[[l.f.forChild(N)],l.f]}),t})();var z=i("ugYk"),D=i("zOQo");let x=(()=>{class t{}return t.\u0275mod=m.Mb({type:t}),t.\u0275inj=m.Lb({factory:function(a){return new(a||t)},providers:[],imports:[[C,z.a,D.a,o.c,T.e,O.b,e.b,r.b,n.f,c.b,v.b,s.a,S.b]]}),t})()}}]);