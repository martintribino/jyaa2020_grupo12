(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{cppH:function(t,e,r){"use strict";r.r(e),r.d(e,"ObrasModule",(function(){return z}));var a=r("tyNb"),o=r("M9IT"),n=r("qR9t"),i=r("+0xr"),c=r("2Vo4"),s=r("hbUw"),l=r("fXoL"),b=r("dXND"),m=r("dNgK"),u=r("0IaG"),d=r("n3We"),h=r("ofXK"),f=r("bTqV"),p=r("Qu3c"),g=r("NFeN"),O=r("Xa2L");function y(t,e){1&t&&l.Pb(0,"div")}function S(t,e){1&t&&(l.Ub(0,"mat-header-cell"),l.Ub(1,"h2"),l.Ac(2,"Obras"),l.Tb(),l.Tb())}function T(t,e){if(1&t){const t=l.Vb();l.Ub(0,"mat-header-cell",17),l.Ub(1,"button",18),l.bc("click",(function(){return l.sc(t),l.fc(2).onCreate()})),l.Ub(2,"mat-icon"),l.Ac(3,"person_add_alt_1"),l.Tb(),l.Tb(),l.Tb()}}function C(t,e){1&t&&(l.Ub(0,"mat-header-cell"),l.Ac(1,"Nombre"),l.Tb())}function U(t,e){if(1&t&&(l.Ub(0,"mat-cell"),l.Ac(1),l.Tb()),2&t){const t=e.$implicit;l.Bb(1),l.Bc(t.nombre)}}function w(t,e){1&t&&(l.Ub(0,"mat-header-cell"),l.Ac(1,"Descripci\xf3n"),l.Tb())}function F(t,e){if(1&t&&(l.Ub(0,"mat-cell"),l.Ac(1),l.Tb()),2&t){const t=e.$implicit;l.Bb(1),l.Bc(t.descripcion)}}function A(t,e){1&t&&(l.Ub(0,"mat-header-cell"),l.Ac(1,"Artistas"),l.Tb())}function v(t,e){if(1&t&&(l.Ub(0,"mat-cell"),l.Ac(1),l.Tb()),2&t){const t=e.$implicit,r=l.fc(2);l.Bb(1),l.Bc(r.getArtistas(t.artistas,3))}}function B(t,e){1&t&&(l.Ub(0,"mat-header-cell"),l.Ac(1,"Etiquetas"),l.Tb())}function I(t,e){if(1&t&&(l.Ub(0,"mat-cell"),l.Ac(1),l.Tb()),2&t){const t=e.$implicit,r=l.fc(2);l.Bb(1),l.Bc(r.getEtiquetas(t.etiquetas,3))}}function D(t,e){1&t&&l.Pb(0,"mat-header-row")}function x(t,e){1&t&&l.Pb(0,"mat-header-row")}const q=function(t){return["/obras/",t]};function k(t,e){1&t&&l.Pb(0,"mat-row",19),2&t&&l.lc("routerLink",l.nc(1,q,e.$implicit.id))}function j(t,e){if(1&t&&(l.Ub(0,"table",4),l.Sb(1,5),l.yc(2,S,3,0,"mat-header-cell",6),l.Rb(),l.Sb(3,7),l.yc(4,T,4,0,"mat-header-cell",8),l.Rb(),l.Sb(5,9),l.yc(6,C,2,0,"mat-header-cell",6),l.yc(7,U,2,1,"mat-cell",10),l.Rb(),l.Sb(8,11),l.yc(9,w,2,0,"mat-header-cell",6),l.yc(10,F,2,1,"mat-cell",10),l.Rb(),l.Sb(11,12),l.yc(12,A,2,0,"mat-header-cell",6),l.yc(13,v,2,1,"mat-cell",10),l.Rb(),l.Sb(14,13),l.yc(15,B,2,0,"mat-header-cell",6),l.yc(16,I,2,1,"mat-cell",10),l.Rb(),l.yc(17,D,1,0,"mat-header-row",14),l.yc(18,x,1,0,"mat-header-row",14),l.yc(19,k,1,3,"mat-row",15),l.Tb(),l.Pb(20,"mat-paginator",16)),2&t){const t=l.fc();l.lc("dataSource",t.dataSource),l.Bb(17),l.lc("matHeaderRowDef",t.displayTitleCol),l.Bb(1),l.lc("matHeaderRowDef",t.displayedColumns),l.Bb(1),l.lc("matRowDefColumns",t.displayedColumns),l.Bb(1),l.lc("pageSizeOptions",t.pageSizeOptions)}}function P(t,e){1&t&&l.Pb(0,"mat-spinner")}function R(t,e){if(1&t){const t=l.Vb();l.Ub(0,"div",22),l.Ub(1,"h3",23),l.Ac(2,"No hay obras."),l.Tb(),l.Ub(3,"button",24),l.bc("click",(function(){return l.sc(t),l.fc(2).onCreate()})),l.Ub(4,"mat-icon"),l.Ac(5,"person_add_alt_1"),l.Tb(),l.Tb(),l.Tb()}}function N(t,e){if(1&t&&(l.yc(0,P,1,0,"mat-spinner",20),l.yc(1,R,6,0,"div",21)),2&t){const t=l.fc();l.lc("ngIf",t.loading),l.Bb(1),l.lc("ngIf",!t.loading)}}const L=[{path:"",children:[{path:"",component:(()=>{class t{constructor(t,e,r,a){this.obraServ=t,this.changeDetectorRef=e,this.snackBar=r,this.dialog=a,this.obrasSubject=new c.a([]),this.loading=!1,this.pageSizeOptions=[5,10,20],this.displayTitleCol=["titulo","action"],this.displayedColumns=["nombre","descripcion","artistas","etiquetas"],this.searchColumns=["nombre","descripcion","artistas","etiquetas"],this.searchSelectedColumns=this.searchColumns,this.predicateFn=(t,e)=>{for(const[a,o]of Object.entries(t))if(this.searchSelectedColumns.includes(a)&&("string"==typeof o&&-1!=o.toLowerCase().indexOf(e)||"number"==typeof o&&-1!=o.toString().indexOf(e)))return!0;var r="";return!(!this.searchSelectedColumns.includes("artistas")||(t.artistas.map(t=>{r+=`${t.nombre}${t.apellido}${t.apodo}`}),-1==r.toLowerCase().indexOf(e)))||!(!this.searchSelectedColumns.includes("etiquetas")||(r="",t.etiquetas.map(t=>{r+=""+t.nombre}),-1==r.toLowerCase().indexOf(e)))},this.obrasSubject.next([]),this.dataSource=new i.k([])}ngOnInit(){this.loading=!0,this.obraServ.getObras().subscribe(t=>this.onSuccess(t),t=>this.onError(t),()=>this.loading=!1)}ngOnDestroy(){this.dataSource&&this.dataSource.disconnect()}onSuccess(t){this.changeDataSource(t),this.loading=!1}changeDataSource(t){this.obrasSubject.next(t),this.changeDetectorRef.detectChanges(),this.dataSource=new i.k(t),this.obs=this.dataSource.connect(),this.dataSource.paginator=this.paginator,this.dataSource.filterPredicate=this.predicateFn}onError(t){this.obrasSubject.next([]),this.dataSource&&this.dataSource.disconnect(),this.loading=!1}onCreate(){this.dialog.open(s.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:{action:n.a.crear,data:{id:null,nombre:"",descripcion:"",duracion:0,fotos:[],artistas:[],etiquetas:[],usuariosFav:[]}}}).afterClosed().subscribe(t=>{let e=t;null!=e&&this.obraServ.crearObra(e).subscribe(()=>{this.mostrarMensaje("Se ha creado correctamente la obra "+e.nombre,"success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha podido crear la obra "+e.nombre,"error")})})}getArtistas(t,e,r=", "){let a="";return null==t||0==t.length?"No hay artistas.":(t.forEach(t=>{a+=`${t.nombre} ${t.apellido}`}),a)}getEtiquetas(t,e,r=", "){let a="";return null==t||0==t.length?"No hay etiquetas.":(t.forEach(t=>{a+=""+t.nombre}),a)}onFilterSearch(t){this.searchSelectedColumns=t.campos,null!=this.dataSource.data&&this.dataSource.data.length>0&&(this.dataSource.filter=t.filtro.trim().toLowerCase())}mostrarMensaje(t,e="",r=n.d,a="bottom"){this.snackBar.open(t,"",{duration:r,verticalPosition:a,panelClass:e})}}return t.\u0275fac=function(e){return new(e||t)(l.Ob(b.a),l.Ob(l.h),l.Ob(m.a),l.Ob(u.b))},t.\u0275cmp=l.Ib({type:t,selectors:[["app-obras"]],viewQuery:function(t,e){var r;1&t&&l.Gc(o.a,!0),2&t&&l.oc(r=l.cc())&&(e.paginator=r.first)},decls:7,vars:6,consts:[[3,"searchFields","filterSearch"],[4,"ngIf","ngIfThen","ngIfElse"],["ifBlock",""],["elseBlock",""],["mat-table","","multiTemplateDataRows","",1,"obra-table","mat-elevation-z8",3,"dataSource"],["matColumnDef","titulo"],[4,"matHeaderCellDef"],["matColumnDef","action"],["class","add-cell",4,"matHeaderCellDef"],["matColumnDef","nombre"],[4,"matCellDef"],["matColumnDef","descripcion"],["matColumnDef","artistas"],["matColumnDef","etiquetas"],[4,"matHeaderRowDef"],["class","click-row",3,"routerLink",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],[1,"add-cell"],["mat-mini-fab","","color","primary","matTooltip","Crear Obra","matTooltipPosition","above","aria-label","Crear Obra",1,"fab-button",3,"click"],[1,"click-row",3,"routerLink"],[4,"ngIf"],["class","no-obra",4,"ngIf"],[1,"no-obra"],["matLine",""],["color","primary","mat-mini-fab","","aria-label","Crear obra",3,"click"]],template:function(t,e){if(1&t&&(l.Ub(0,"app-filtro-tabla",0),l.bc("filterSearch",(function(t){return e.onFilterSearch(t)})),l.Tb(),l.yc(1,y,1,0,"div",1),l.gc(2,"async"),l.yc(3,j,21,5,"ng-template",null,2,l.zc),l.yc(5,N,2,2,"ng-template",null,3,l.zc)),2&t){const t=l.pc(4),a=l.pc(6);var r;const o=(null==(r=l.hc(2,4,e.obs))?null:r.length)>0;l.lc("searchFields",e.searchColumns),l.Bb(1),l.lc("ngIf",o)("ngIfThen",t)("ngIfElse",a)}},directives:[d.a,h.n,i.j,i.c,i.e,i.b,i.g,i.i,o.a,i.d,f.a,p.a,g.a,i.a,i.f,i.h,a.c,O.b],pipes:[h.b],styles:[".no-obra[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.mat-progress-spinner[_ngcontent-%COMP%]{margin-top:2em}"]}),t})(),pathMatch:"full"},{path:":id",loadChildren:()=>Promise.all([r.e(3),r.e(0),r.e(26)]).then(r.bind(null,"D2Nj")).then(t=>t.ObraModule),pathMatch:"full",canLoad:[r("I8kz").a],data:{allowedRoles:[n.e.Administrador]}}]}];let M=(()=>{class t{}return t.\u0275mod=l.Mb({type:t}),t.\u0275inj=l.Lb({factory:function(e){return new(e||t)},imports:[[a.f.forChild(L)],a.f]}),t})();var E=r("STbY"),$=r("OLjN"),_=r("3Pt+");let z=(()=>{class t{}return t.\u0275mod=l.Mb({type:t}),t.\u0275inj=l.Lb({factory:function(e){return new(e||t)},providers:[],imports:[[M,h.c,i.l,o.c,g.b,u.f,f.b,O.a,p.b,E.a,_.k,_.v,$.a]]}),t})()},hbUw:function(t,e,r){"use strict";r.d(e,"a",(function(){return C}));var a=r("3Pt+"),o=r("0IaG"),n=r("2Vo4"),i=r("fXoL"),c=r("gOGa"),s=r("kmnG"),l=r("qFsG"),b=r("ofXK"),m=r("d3UM"),u=r("FKr1");function d(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"El campo debe tener al menos 2 caracteres "),i.Tb())}function h(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"El campo debe tener como m\xe1ximo 100 caracteres "),i.Tb())}function f(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"Campo requerido"),i.Tb())}function p(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"El campo debe tener como m\xe1ximo 150 caracteres "),i.Tb())}function g(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"Campo requerido"),i.Tb())}function O(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"El campo debe ser mayor a 0 "),i.Tb())}function y(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"Campo requerido"),i.Tb())}function S(t,e){if(1&t&&(i.Ub(0,"mat-option",8),i.Ac(1),i.Tb()),2&t){const t=e.$implicit;i.lc("value",t),i.Bb(1),i.Cc(" ",t.nombre," ")}}function T(t,e){1&t&&(i.Ub(0,"mat-error"),i.Ac(1,"Campo requerido"),i.Tb())}let C=(()=>{class t{constructor(t,e,r){this.artistaServ=t,this.dialogRef=e,this.body=r,this.obra=null,this.tipos=[],this.tipoSelected="",this.artistasSubject=new n.a([]),this.artistasObs=this.artistasSubject.asObservable(),this.artistasSubject.next([]),this.obra=r.data,this.action=r.action,this.obraForm=new a.h({id:new a.e(this.obra.id),nombre:new a.e(this.obra.nombre),descripcion:new a.e(this.obra.descripcion),duracion:new a.e(this.obra.duracion,[a.x.min(0)]),fotos:new a.e(this.obra.fotos),artistas:new a.e([])})}ngOnInit(){this.artistaServ.getArtistas().subscribe(t=>{this.artistasSubject.next(t),this.getObraForm.artistas.setValue(this.obra.artistas)},t=>{this.artistasSubject.next([]),this.getObraForm.artistas.setValue([])})}ngOnDestroy(){}onSubmit(){this.dialogRef.close(this.obraForm.value)}clean(){this.obraForm.reset()}get getObraForm(){return this.obraForm.controls}compare(t,e){return t.id==e.id?t:null}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(c.a),i.Ob(o.g),i.Ob(o.a))},t.\u0275cmp=i.Ib({type:t,selectors:[["app-form-obra"]],decls:41,vars:15,consts:[[1,"dialog","obra-form",3,"formGroup"],["matInput","","type","text","formControlName","nombre","autocomplete","off","maxlength","100","minlength","2","required",""],[4,"ngIf"],["matInput","","type","text","formControlName","descripcion","autocomplete","off","maxlength","150","required",""],["matInput","","type","number","formControlName","duracion","min","0","required",""],["formControlName","artistas","multiple","",3,"compareWith"],[3,"value",4,"ngFor","ngForOf"],["type","submit",1,"submit-button",3,"mat-dialog-close","disabled","click"],[3,"value"]],template:function(t,e){1&t&&(i.Ub(0,"h4"),i.Ac(1,"Datos de la obra"),i.Tb(),i.Ub(2,"mat-dialog-content"),i.Ub(3,"form",0),i.Ub(4,"mat-form-field"),i.Ub(5,"mat-label"),i.Ac(6,"Nombre"),i.Tb(),i.Pb(7,"input",1),i.Ub(8,"mat-hint"),i.Ac(9,"Nombre"),i.Tb(),i.yc(10,d,2,0,"mat-error",2),i.yc(11,h,2,0,"mat-error",2),i.yc(12,f,2,0,"mat-error",2),i.Tb(),i.Ub(13,"mat-form-field"),i.Ub(14,"mat-label"),i.Ac(15,"Descripci\xf3n"),i.Tb(),i.Pb(16,"input",3),i.Ub(17,"mat-hint"),i.Ac(18,"Descripci\xf3n"),i.Tb(),i.yc(19,p,2,0,"mat-error",2),i.yc(20,g,2,0,"mat-error",2),i.Tb(),i.Ub(21,"mat-form-field"),i.Ub(22,"mat-label"),i.Ac(23,"Duraci\xf3n"),i.Tb(),i.Pb(24,"input",4),i.Ub(25,"mat-hint"),i.Ac(26,"Duraci\xf3n"),i.Tb(),i.yc(27,O,2,0,"mat-error",2),i.yc(28,y,2,0,"mat-error",2),i.Tb(),i.Ub(29,"mat-form-field"),i.Ub(30,"mat-label"),i.Ac(31,"Artistas"),i.Tb(),i.Ub(32,"mat-select",5),i.yc(33,S,2,2,"mat-option",6),i.gc(34,"async"),i.Tb(),i.Ub(35,"mat-hint"),i.Ac(36,"Artistas"),i.Tb(),i.yc(37,T,2,0,"mat-error",2),i.Tb(),i.Tb(),i.Tb(),i.Ub(38,"mat-dialog-actions"),i.Ub(39,"button",7),i.bc("click",(function(){return e.onSubmit()})),i.Ac(40," Enviar "),i.Tb(),i.Tb()),2&t&&(i.Bb(3),i.lc("formGroup",e.obraForm),i.Bb(7),i.lc("ngIf",null==e.getObraForm.nombre||null==e.getObraForm.nombre.errors?null:e.getObraForm.nombre.errors.minlength),i.Bb(1),i.lc("ngIf",null==e.getObraForm.nombre||null==e.getObraForm.nombre.errors?null:e.getObraForm.nombre.errors.maxlength),i.Bb(1),i.lc("ngIf",null==e.getObraForm.nombre||null==e.getObraForm.nombre.errors?null:e.getObraForm.nombre.errors.required),i.Bb(7),i.lc("ngIf",null==e.getObraForm.descripcion||null==e.getObraForm.descripcion.errors?null:e.getObraForm.descripcion.errors.maxlength),i.Bb(1),i.lc("ngIf",null==e.getObraForm.descripcion||null==e.getObraForm.descripcion.errors?null:e.getObraForm.descripcion.errors.required),i.Bb(7),i.lc("ngIf",null==e.getObraForm.duracion||null==e.getObraForm.duracion.errors?null:e.getObraForm.duracion.errors.min),i.Bb(1),i.lc("ngIf",null==e.getObraForm.duracion||null==e.getObraForm.duracion.errors?null:e.getObraForm.duracion.errors.required),i.Bb(4),i.lc("compareWith",e.compare),i.Bb(1),i.lc("ngForOf",i.hc(34,13,e.artistasObs)),i.Bb(4),i.lc("ngIf",null==e.getObraForm.artistas||null==e.getObraForm.artistas.errors?null:e.getObraForm.artistas.errors.required),i.Bb(2),i.lc("mat-dialog-close",e.obra)("disabled",e.obraForm.invalid))},directives:[o.e,a.y,a.r,a.i,s.c,s.g,l.b,a.b,a.q,a.g,a.l,a.m,a.w,s.f,b.n,a.u,m.a,b.m,o.c,o.d,s.b,u.n],pipes:[b.b],styles:[".obra-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:center;margin:12px auto}"]}),t})()}}]);