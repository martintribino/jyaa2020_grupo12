(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{KpyH:function(e,a,t){"use strict";t.r(a),t.d(a,"UsuariosModule",(function(){return K}));var i=t("tyNb"),o=t("M9IT"),r=t("+0xr"),n=t("2Vo4"),c=t("qR9t"),s=t("E5Vc"),l=t("661J"),u=t("fXoL"),b=t("ESM5"),d=t("dNgK"),m=t("0IaG"),h=t("n3We"),f=t("ofXK"),p=t("bTqV"),g=t("Qu3c"),S=t("NFeN"),U=t("Xa2L");function y(e,a){1&e&&u.Pb(0,"div")}function C(e,a){1&e&&(u.Ub(0,"mat-header-cell"),u.Ub(1,"h2"),u.Ac(2,"Usuarios"),u.Tb(),u.Tb())}function w(e,a){if(1&e){const e=u.Vb();u.Ub(0,"mat-header-cell",17),u.Ub(1,"button",18),u.bc("click",(function(){return u.sc(e),u.fc(2).onCreate()})),u.Ub(2,"mat-icon"),u.Ac(3,"person_add_alt_1"),u.Tb(),u.Tb(),u.Tb()}}function v(e,a){1&e&&(u.Ub(0,"mat-header-cell"),u.Ac(1,"Nombre"),u.Tb())}function T(e,a){if(1&e&&(u.Ub(0,"mat-cell"),u.Ac(1),u.Tb()),2&e){const e=a.$implicit;u.Bb(1),u.Dc("",e.nombre," ",e.apellido,"")}}function D(e,a){1&e&&(u.Ub(0,"mat-header-cell"),u.Ac(1,"Usuario"),u.Tb())}function j(e,a){if(1&e&&(u.Ub(0,"mat-cell"),u.Ac(1),u.Tb()),2&e){const e=a.$implicit;u.Bb(1),u.Bc(e.nombreUsuario)}}function O(e,a){1&e&&(u.Ub(0,"mat-header-cell"),u.Ac(1,"Rol"),u.Tb())}function M(e,a){if(1&e&&(u.Ub(0,"mat-cell"),u.Ac(1),u.Tb()),2&e){const e=a.$implicit;u.Bb(1),u.Bc(e.rol.nombre)}}function R(e,a){1&e&&(u.Ub(0,"mat-header-cell"),u.Ac(1,"Email"),u.Tb())}function k(e,a){if(1&e&&(u.Ub(0,"mat-cell"),u.Ac(1),u.Tb()),2&e){const e=a.$implicit;u.Bb(1),u.Bc(e.email)}}function x(e,a){1&e&&u.Pb(0,"mat-header-row")}function I(e,a){1&e&&u.Pb(0,"mat-header-row")}const B=function(e){return["/usuarios/",e]};function L(e,a){1&e&&u.Pb(0,"mat-row",19),2&e&&u.lc("routerLink",u.nc(1,B,a.$implicit.id))}function z(e,a){if(1&e&&(u.Ub(0,"table",4),u.Sb(1,5),u.yc(2,C,3,0,"mat-header-cell",6),u.Rb(),u.Sb(3,7),u.yc(4,w,4,0,"mat-header-cell",8),u.Rb(),u.Sb(5,9),u.yc(6,v,2,0,"mat-header-cell",6),u.yc(7,T,2,2,"mat-cell",10),u.Rb(),u.Sb(8,11),u.yc(9,D,2,0,"mat-header-cell",6),u.yc(10,j,2,1,"mat-cell",10),u.Rb(),u.Sb(11,12),u.yc(12,O,2,0,"mat-header-cell",6),u.yc(13,M,2,1,"mat-cell",10),u.Rb(),u.Sb(14,13),u.yc(15,R,2,0,"mat-header-cell",6),u.yc(16,k,2,1,"mat-cell",10),u.Rb(),u.yc(17,x,1,0,"mat-header-row",14),u.yc(18,I,1,0,"mat-header-row",14),u.yc(19,L,1,3,"mat-row",15),u.Tb(),u.Pb(20,"mat-paginator",16)),2&e){const e=u.fc();u.lc("dataSource",e.dataSource),u.Bb(17),u.lc("matHeaderRowDef",e.displayTitleCol),u.Bb(1),u.lc("matHeaderRowDef",e.displayedColumns),u.Bb(1),u.lc("matRowDefColumns",e.displayedColumns),u.Bb(1),u.lc("pageSizeOptions",e.pageSizeOptions)}}function A(e,a){1&e&&u.Pb(0,"mat-spinner")}function P(e,a){if(1&e){const e=u.Vb();u.Ub(0,"div",22),u.Ub(1,"h3",23),u.Ac(2,"No hay usuarios."),u.Tb(),u.Ub(3,"button",24),u.bc("click",(function(){return u.sc(e),u.fc(2).onCreate()})),u.Ub(4,"mat-icon"),u.Ac(5,"person_add_alt_1"),u.Tb(),u.Tb(),u.Tb()}}function E(e,a){if(1&e&&(u.yc(0,A,1,0,"mat-spinner",20),u.yc(1,P,6,0,"div",21)),2&e){const e=u.fc();u.lc("ngIf",e.loading),u.Bb(1),u.lc("ngIf",!e.loading)}}const N=[{path:"",children:[{path:"",component:(()=>{class e{constructor(e,a,t,i){this.usuService=e,this.changeDetectorRef=a,this.snackBar=t,this.dialog=i,this.usuariosSubject=new n.a([]),this.usuarios=this.usuariosSubject.asObservable(),this.obs=new n.a([]),this.loading=!1,this.pageSizeOptions=[5,10,20],this.displayTitleCol=["titulo","action"],this.displayedColumns=["nombre","nombreUsuario","email","rol"],this.searchColumns=["nombre","apellido","nombreUsuario","email","dni","rol"],this.searchSelectedColumns=this.searchColumns,this.predicateFn=(e,a)=>{for(const[i,o]of Object.entries(e))if(this.searchSelectedColumns.includes(i)&&("string"==typeof o&&-1!=o.toLowerCase().indexOf(a)||"number"==typeof o&&-1!=o.toString().indexOf(a)))return!0;var t="";return!(!this.searchSelectedColumns.includes("rol")||-1==(t+=""+e.rol.nombre).toLowerCase().indexOf(a))},this.usuariosSubject.next([]),this.dataSource=new r.k([])}ngOnInit(){this.loading=!0,this.usuService.getUsuarios().subscribe(e=>this.onSuccess(e),e=>this.onError(e),()=>this.loading=!1)}ngOnDestroy(){this.dataSource&&this.dataSource.disconnect()}onSuccess(e){this.loading=!1,this.usuariosSubject.next(e),this.changeDataSource(e)}onError(e){this.usuariosSubject.next([]),this.dataSource&&this.dataSource.disconnect(),this.loading=!1}changeDataSource(e){this.usuariosSubject.next(e),this.changeDetectorRef.detectChanges(),this.dataSource=new r.k(e),this.obs=this.dataSource.connect(),this.dataSource.paginator=this.paginator,this.dataSource.filterPredicate=this.predicateFn}onCreate(){this.dialog.open(s.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:{action:c.a.crear,data:{id:null,nombreUsuario:"",clave:null,nombre:"",apellido:"",telefono:0,dni:0,email:"",rol:null,direccion:null,avatar:""}}}).afterClosed().subscribe(e=>{let a=e;null!=a&&this.usuService.crearUsuario(a).subscribe(()=>{this.mostrarMensaje("Se ha creado correctamente el usuario "+a.nombreUsuario,"success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha podido crear el usuario "+a.nombreUsuario,"error")})})}onEditDireccion(e){null!=e&&this.dialog.open(l.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:e.direccion}).afterClosed().subscribe(a=>{null!=a&&(e.direccion=a,e.clave=null,this.usuService.actualizarUsuario(e).subscribe(()=>{this.mostrarMensaje("Se ha actualizado correctamente la direcci\xf3n del usuario "+e.nombreUsuario,"success")},()=>{this.mostrarMensaje("No se ha podido actualizar la direcci\xf3n del usuario "+e.nombreUsuario,"error")}))})}onDelete(e){null!=e&&this.usuService.eliminarUsuario(e).subscribe(()=>{this.mostrarMensaje("Se ha dado de baja correctamente al usuario "+e.nombreUsuario,"success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha podido dar de baja el usuario "+e.nombreUsuario,"error")})}onEdit(e){this.dialog.open(s.a,{maxWidth:"550px",maxHeight:"100%",height:"auto",data:{action:c.a.editar,data:e}}).afterClosed().subscribe(a=>{let t=a;null!=t&&(t.id=e.id,t.direccion=null,this.usuService.actualizarUsuario(t).subscribe(()=>{this.mostrarMensaje("Se ha editado correctamente el usuario "+t.nombreUsuario,"success"),this.ngOnInit()},()=>{this.mostrarMensaje("No se ha podido actualizar el usuario "+t.nombreUsuario,"error")}))})}onFilterSearch(e){this.searchSelectedColumns=e.campos,null!=this.dataSource.data&&this.dataSource.data.length>0&&(this.dataSource.filter=e.filtro.trim().toLowerCase())}mostrarMensaje(e,a="",t=c.d,i="bottom"){this.snackBar.open(e,"",{duration:t,verticalPosition:i,panelClass:a})}}return e.\u0275fac=function(a){return new(a||e)(u.Ob(b.a),u.Ob(u.h),u.Ob(d.a),u.Ob(m.b))},e.\u0275cmp=u.Ib({type:e,selectors:[["app-usuarios"]],viewQuery:function(e,a){var t;1&e&&u.Gc(o.a,!0),2&e&&u.oc(t=u.cc())&&(a.paginator=t.first)},decls:7,vars:6,consts:[[3,"searchFields","filterSearch"],[4,"ngIf","ngIfThen","ngIfElse"],["ifBlock",""],["elseBlock",""],["mat-table","","multiTemplateDataRows","",1,"usuarios-table","mat-elevation-z8",3,"dataSource"],["matColumnDef","titulo"],[4,"matHeaderCellDef"],["matColumnDef","action"],["class","add-cell",4,"matHeaderCellDef"],["matColumnDef","nombre"],[4,"matCellDef"],["matColumnDef","nombreUsuario"],["matColumnDef","rol"],["matColumnDef","email"],[4,"matHeaderRowDef"],["class","click-row",3,"routerLink",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],[1,"add-cell"],["mat-mini-fab","","color","primary","matTooltip","Crear Usuario","matTooltipPosition","above","aria-label","Crear Usuario",1,"fab-button",3,"click"],[1,"click-row",3,"routerLink"],[4,"ngIf"],["class","no-usuarios",4,"ngIf"],[1,"no-usuarios"],["matLine",""],["color","primary","mat-mini-fab","","aria-label","Crear usuario",3,"click"]],template:function(e,a){if(1&e&&(u.Ub(0,"app-filtro-tabla",0),u.bc("filterSearch",(function(e){return a.onFilterSearch(e)})),u.Tb(),u.yc(1,y,1,0,"div",1),u.gc(2,"async"),u.yc(3,z,21,5,"ng-template",null,2,u.zc),u.yc(5,E,2,2,"ng-template",null,3,u.zc)),2&e){const e=u.pc(4),i=u.pc(6);var t;const o=(null==(t=u.hc(2,4,a.obs))?null:t.length)>0;u.lc("searchFields",a.searchColumns),u.Bb(1),u.lc("ngIf",o)("ngIfThen",e)("ngIfElse",i)}},directives:[h.a,f.n,r.j,r.c,r.e,r.b,r.g,r.i,o.a,r.d,p.a,g.a,S.a,r.a,r.f,r.h,i.c,U.b],pipes:[f.b],styles:[".no-usuarios[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%}.mat-progress-spinner[_ngcontent-%COMP%]{margin-top:2em}"]}),e})(),pathMatch:"full"},{path:":id",loadChildren:()=>Promise.all([t.e(7),t.e(13)]).then(t.bind(null,"w9v7")).then(e=>e.UsuarioModule),pathMatch:"full",canLoad:[t("I8kz").a],data:{allowedRoles:[c.e.Administrador]}}]}];let F=(()=>{class e{}return e.\u0275mod=u.Mb({type:e}),e.\u0275inj=u.Lb({factory:function(a){return new(a||e)},imports:[[i.f.forChild(N)],i.f]}),e})();var H=t("Dh3D");t("8LU1"),t("XNiG"),t("quSY"),t("0EQZ");let _=(()=>{class e{}return e.\u0275mod=u.Mb({type:e}),e.\u0275inj=u.Lb({factory:function(a){return new(a||e)}}),e})();var V=t("+rOU");t("u47x"),t("FtGj"),t("/uUt"),t("JX91"),t("pLZG"),t("IzEk"),t("R1ws"),t("EY2u"),t("VRyK"),t("R0Ic");let G=(()=>{class e{}return e.\u0275mod=u.Mb({type:e}),e.\u0275inj=u.Lb({factory:function(a){return new(a||e)},imports:[[f.c,_,V.f]]}),e})();var X=t("STbY"),$=t("3Pt+"),J=t("OLjN");let K=(()=>{class e{}return e.\u0275mod=u.Mb({type:e}),e.\u0275inj=u.Lb({factory:function(a){return new(a||e)},providers:[],imports:[[F,f.c,r.l,o.c,H.c,S.b,m.f,p.b,d.b,g.b,G,U.a,X.a,$.k,$.v,J.a]]}),e})()}}]);